{% extends "app/base.html" %}
{% load static %}

{% block content %}
<style>
  .register-card { border-radius: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); overflow: hidden; }
  .custom-input-group input { border-radius: 25px !important; padding: 10px 45px 10px 20px !important; border: 1px solid #ced4da !important; width: 100%; height: 45px; }
  .input-wrapper { position: relative; width: 100%; }
  .toggle-password { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; z-index: 10; font-size: 1.1rem; opacity: 0.5; }
  .field-label { color: #1a472a; font-weight: bold; font-size: 0.9rem; margin-bottom: 5px; margin-left: 10px; display: block; }
  .btn-custom-blue { background-color: #007bff; color: white; border-radius: 25px; padding: 10px; font-weight: bold; border: none; width: 100%; transition: 0.3s; }
  /* M√†u ƒë·ªè cho d·∫•u sao b·∫Øt bu·ªôc */
  .required-star { color: #d42426; margin-left: 3px; }
</style>

<section class="vh-100" style="background-color: #eee; padding-top: 20px;">
  <div class="container">
    <div class="row d-flex justify-content-center align-items-center">
      <div class="col-lg-12 col-xl-11">
        <div class="card text-black register-card">
          <div class="card-body p-md-5">
            <div class="row justify-content-center">
              
              <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1 custom-input-group">
                <p class="text-center h1 fw-bold mb-4 mt-2">T·∫°o t√†i kho·∫£n</p>

                {% if messages %}
                  {% for message in messages %}
                    <div class="alert alert-{% if message.tags == 'error' %}danger{% else %}{{ message.tags }}{% endif %} alert-dismissible fade show text-center shadow-sm" role="alert" style="border-radius: 15px; font-size: 0.9rem;">
                      <strong>Th√¥ng b√°o:</strong> {{ message }}
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                  {% endfor %}
                {% endif %}

                <form method="POST" id="registerForm">
                  {% csrf_token %}

                  <div class="mb-3">
                    <label class="field-label">T√™n ƒëƒÉng nh·∫≠p<span class="required-star">*</span></label>
                    {{ form.username }}
                  </div>

                  <div class="mb-3">
                    <label class="field-label">Email c·ªßa b·∫°n<span class="required-star">*</span></label>
                    {{ form.email }}
                    <small class="text-muted ms-2" style="font-size: 0.75rem;">(D√πng ƒë·ªÉ kh√¥i ph·ª•c m·∫≠t kh·∫©u khi c·∫ßn)</small>
                  </div>

                  <div class="mb-3">
                    <label class="field-label">M·∫≠t kh·∫©u<span class="required-star">*</span></label>
                    <div class="input-wrapper">
                      {{ form.password1 }}
                      <span class="toggle-password" onclick="togglePass('input[name=\'password1\']', this)">üëÅÔ∏è</span>
                    </div>
                  </div>

                  <div class="mb-4">
                    <label class="field-label">Nh·∫≠p l·∫°i m·∫≠t kh·∫©u<span class="required-star">*</span></label>
                    <div class="input-wrapper">
                      {{ form.password2 }}
                      <span class="toggle-password" onclick="togglePass('input[name=\'password2\']', this)">üëÅÔ∏è</span>
                    </div>
                  </div>

                  <button type="submit" class="btn-custom-blue shadow-sm">ƒêƒÉng k√Ω ngay</button>
                  
                  <p class="text-center mt-3">
                    <small class="fw-bold">ƒê√£ c√≥ t√†i kho·∫£n? <a href="{% url 'login' %}" style="text-decoration: none;">ƒêƒÉng nh·∫≠p ngay</a></small>
                  </p>
                </form>
              </div>

              <div class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2">
                <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-registration/draw1.webp"
                  class="img-fluid" alt="Sample image" style="max-height: 400px;">
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // √âp bu·ªôc thu·ªôc t√≠nh required cho email b·∫±ng Javascript ƒë·ªÉ ch·∫Øc ch·∫Øn
  document.addEventListener("DOMContentLoaded", function() {
    const emailInput = document.querySelector('input[name="email"]');
    if (emailInput) {
      emailInput.setAttribute('required', 'true');
    }
  });
</script>
{% endblock content %}